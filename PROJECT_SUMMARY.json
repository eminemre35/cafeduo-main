{
    "projectName": "CafeDuo",
    "version": "2.0.0",
    "lastUpdated": "2025-12-16",
    "description": "A gamified cafe loyalty platform where users earn points by playing multiplayer games in cafes",
    "techStack": {
        "frontend": {
            "framework": "React 18 + TypeScript",
            "bundler": "Vite 7",
            "styling": "TailwindCSS 4",
            "router": "react-router-dom 7"
        },
        "backend": {
            "runtime": "Node.js",
            "framework": "Express.js",
            "database": "PostgreSQL",
            "hosting": "Render.com"
        },
        "security": {
            "helmet": true,
            "rateLimit": "100 req/15min",
            "bcrypt": "10 rounds",
            "recaptcha": "v2"
        }
    },
    "architecture": {
        "frontend": {
            "entryPoint": "src/main.tsx",
            "componentsDir": "components/",
            "apiClient": "lib/api.ts",
            "types": "types.ts"
        },
        "backend": {
            "entryPoint": "backend/server.js",
            "database": "backend/db.js",
            "port": 3001
        }
    },
    "database": {
        "tables": [
            {
                "name": "users",
                "columns": [
                    "id",
                    "username",
                    "email",
                    "password_hash",
                    "points",
                    "wins",
                    "games_played",
                    "department",
                    "is_admin",
                    "role",
                    "cafe_id",
                    "table_number",
                    "last_daily_bonus",
                    "avatar_url"
                ]
            },
            {
                "name": "cafes",
                "columns": [
                    "id",
                    "name",
                    "latitude",
                    "longitude",
                    "table_count",
                    "radius",
                    "daily_pin"
                ]
            },
            {
                "name": "games",
                "columns": [
                    "id",
                    "host_name",
                    "guest_name",
                    "game_type",
                    "points",
                    "table_code",
                    "status",
                    "player1_move",
                    "player2_move",
                    "game_state"
                ]
            },
            {
                "name": "rewards",
                "columns": [
                    "id",
                    "title",
                    "cost",
                    "description",
                    "icon",
                    "cafe_id",
                    "is_active"
                ]
            },
            {
                "name": "user_items",
                "columns": [
                    "id",
                    "user_id",
                    "item_id",
                    "item_title",
                    "code",
                    "is_used",
                    "used_at",
                    "redeemed_at"
                ]
            }
        ]
    },
    "apiEndpoints": {
        "auth": [
            "POST /api/auth/register",
            "POST /api/auth/verify",
            "POST /api/auth/login",
            "POST /api/auth/google"
        ],
        "users": [
            "GET /api/users/:id",
            "PUT /api/users/:id",
            "GET /api/users/leaderboard"
        ],
        "cafes": [
            "GET /api/cafes",
            "POST /api/cafes/check-in",
            "PUT /api/cafes/:id/pin"
        ],
        "games": [
            "GET /api/games",
            "POST /api/games",
            "GET /api/games/:id",
            "PUT /api/games/:id/join",
            "PUT /api/games/:id/move",
            "PUT /api/games/:id/finish",
            "DELETE /api/games/:id"
        ],
        "shop": [
            "POST /api/shop/buy",
            "GET /api/shop/inventory/:userId"
        ],
        "rewards": [
            "GET /api/rewards",
            "POST /api/rewards",
            "DELETE /api/rewards/:id"
        ],
        "coupons": [
            "POST /api/coupons/use"
        ]
    },
    "features": {
        "authentication": {
            "email": true,
            "google": true,
            "recaptcha": true,
            "dailyBonus": "5 points"
        },
        "games": [
            {
                "name": "Arena Savaşı",
                "type": "turn-based combat",
                "component": "ArenaBattle.tsx",
                "multiplayer": true,
                "botSupport": true,
                "pointsForWin": 10
            },
            {
                "name": "Zindan Savaşı",
                "type": "card-based combat",
                "component": "DungeonClash.tsx",
                "multiplayer": true,
                "botSupport": true,
                "pointsForWin": 10
            }
        ],
        "cafeCheckIn": {
            "method": "PIN code",
            "validation": "strict",
            "defaultPin": "0000"
        },
        "shop": {
            "canBuyRewards": true,
            "couponGeneration": true,
            "cafeSpecificRewards": true
        }
    },
    "userRoles": [
        {
            "role": "user",
            "permissions": [
                "play_games",
                "earn_points",
                "buy_rewards"
            ]
        },
        {
            "role": "cafe_admin",
            "permissions": [
                "manage_rewards",
                "verify_coupons",
                "change_pin"
            ]
        },
        {
            "role": "admin",
            "permissions": [
                "all"
            ]
        }
    ],
    "keyComponents": {
        "pages": [
            {
                "name": "Hero.tsx",
                "path": "/",
                "description": "Landing page"
            },
            {
                "name": "Dashboard.tsx",
                "path": "/dashboard",
                "description": "Main game lobby and shop"
            },
            {
                "name": "CafeDashboard.tsx",
                "path": "/cafe-admin",
                "description": "Cafe admin panel"
            },
            {
                "name": "AdminPanel.tsx",
                "path": "/admin",
                "description": "Super admin panel"
            }
        ],
        "gameComponents": [
            {
                "name": "ArenaBattle.tsx",
                "description": "Turn-based Soldier vs Orc combat game"
            },
            {
                "name": "DungeonClash.tsx",
                "description": "Card-based combat game"
            }
        ],
        "utilityComponents": [
            {
                "name": "CafeSelection.tsx",
                "description": "PIN-based cafe check-in"
            },
            {
                "name": "AuthModal.tsx",
                "description": "Login/Register modal"
            },
            {
                "name": "CreateGameModal.tsx",
                "description": "Game creation modal"
            }
        ]
    },
    "environmentVariables": [
        {
            "name": "DATABASE_URL",
            "required": true,
            "description": "PostgreSQL connection string"
        },
        {
            "name": "VITE_GOOGLE_CLIENT_ID",
            "required": true,
            "description": "Google OAuth client ID"
        },
        {
            "name": "VITE_RECAPTCHA_SITE_KEY",
            "required": true,
            "description": "reCAPTCHA site key"
        },
        {
            "name": "RECAPTCHA_SECRET_KEY",
            "required": true,
            "description": "reCAPTCHA secret key"
        },
        {
            "name": "GMAIL_USER",
            "required": false,
            "description": "Gmail for email verification"
        },
        {
            "name": "GMAIL_PASS",
            "required": false,
            "description": "Gmail app password"
        },
        {
            "name": "PORT",
            "required": false,
            "default": 3001
        }
    ],
    "deployment": {
        "frontend": {
            "host": "cPanel",
            "domain": "cafeduotr.com",
            "buildCommand": "npm run build",
            "outputDir": "dist/"
        },
        "backend": {
            "host": "Render.com",
            "url": "https://cafeduo-api.onrender.com",
            "startCommand": "node backend/server.js"
        }
    },
    "recentFixes": [
        {
            "date": "2025-12-16",
            "issue": "PIN validation bypass",
            "fix": "Made PIN validation STRICT - always requires matching PIN"
        },
        {
            "date": "2025-12-16",
            "issue": "Missing shop endpoints",
            "fix": "Added /api/shop/buy and /api/shop/inventory/:userId"
        },
        {
            "date": "2025-12-11",
            "issue": "Games starting as bot immediately",
            "fix": "Added explicit isBot state tracking in Dashboard"
        },
        {
            "date": "2025-12-11",
            "issue": "TypeScript cafeId error",
            "fix": "Changed to cafe_id to match User type"
        }
    ],
    "knownIssues": [
        "CORS allows all origins (should be restricted for production)",
        "Memory fallback mode still enabled (should be disabled for production)",
        "No JWT tokens for session management (stateless auth)"
    ],
    "scripts": {
        "dev": "concurrently \"npm run server\" \"npm run client\"",
        "client": "vite",
        "server": "nodemon backend/server.js",
        "build": "vite build",
        "start": "node backend/server.js"
    }
}